{% extends "base.html" %}
{% block title %}Uporabniki – {{ request.state.klub_oznaka or 'Radio klub' }}{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h4 class="mb-0"><i class="bi bi-person-gear me-2 text-primary"></i>Upravljanje uporabnikov</h4>
  <a href="/uporabniki/nov" class="btn btn-success btn-sm">
    <i class="bi bi-person-plus me-1"></i>Dodaj uporabnika
  </a>
</div>

<div class="card">
  <div class="card-body p-0">
    <table class="table table-hover align-middle mb-0">
      <thead class="table-primary">
        <tr>
          <th>Ime in priimek</th>
          <th>Uporabniško ime</th>
          <th>Vloga</th>
          <th class="text-center">Status</th>
          <th class="text-center">Akcije</th>
        </tr>
      </thead>
      <tbody>
        {% for u in uporabniki %}
        <tr>
          <td>{{ u.ime_priimek or '–' }}</td>
          <td><code>{{ u.uporabnisko_ime }}</code></td>
          <td>
            <span class="badge
              {% if u.vloga == 'admin' %}bg-danger
              {% elif u.vloga == 'urednik' %}bg-warning text-dark
              {% else %}bg-secondary{% endif %}">
              {{ u.vloga }}
            </span>
          </td>
          <td class="text-center">
            {% if u.aktiven %}
            <span class="badge bg-success">Aktiven</span>
            {% else %}
            <span class="badge bg-secondary">Neaktiven</span>
            {% endif %}
          </td>
          <td class="text-center">
            <a href="/uporabniki/{{ u.id }}/uredi" class="btn btn-outline-secondary btn-sm">
              <i class="bi bi-pencil"></i>
            </a>
            {% if u.id != user.id %}
            <form method="post" action="/uporabniki/{{ u.id }}/izbrisi" class="d-inline"
                  onsubmit="return confirm('Izbrišete uporabnika {{ u.uporabnisko_ime }}?')">
              <button type="submit" class="btn btn-outline-danger btn-sm">
                <i class="bi bi-trash"></i>
              </button>
            </form>
            {% endif %}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

<div class="alert alert-info mt-3 small">
  <i class="bi bi-info-circle me-1"></i>
  <strong>Vloge:</strong>
  <span class="badge bg-danger ms-1">admin</span> – polni dostop, upravljanje uporabnikov &nbsp;|&nbsp;
  <span class="badge bg-warning text-dark">urednik</span> – ureja članske podatke &nbsp;|&nbsp;
  <span class="badge bg-secondary">bralec</span> – samo ogled
</div>
{% endblock %}
